#!/usr/bin/env node
import { readFileSync, writeFileSync, existsSync } from 'fs'

console.log('üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ README.md...')

// –ß–∏—Ç–∞–µ–º package.json
const packageJson = JSON.parse(readFileSync('package.json', 'utf8'))

const projectName = packageJson.name
const description = packageJson.description || '–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞'
const author = packageJson.author || 'vv0rkz'
const license = packageJson.license || 'MIT'
const repoUrl = packageJson.repository?.url?.replace('git+', '').replace('.git', '') || ''

// –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —à–∞–±–ª–æ–Ω README
const readmeTemplate = `# ${projectName}

${description}

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

\`\`\`bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ó–∞–ø—É—Å–∫
npm run dev
\`\`\`

## üìã –ö–æ–º–∞–Ω–¥—ã

\`\`\`bash
npm run dev              # –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run _ tasks          # –ó–∞–¥–∞—á–∏
npm run _ release        # –†–µ–ª–∏–∑
\`\`\`

> –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [@vv0rkz/js-template](https://github.com/vv0rkz/js-template) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ workflow (husky hooks, changelog, GitHub tasks)

<!-- AUTOGENERATED_SECTION START -->
<!-- AUTOGENERATED_SECTION END -->

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

${license} ¬© ${author}
`

// –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ README
if (existsSync('README.md')) {
  console.log('‚ö†Ô∏è  README.md —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç')
  console.log('üí° –£–¥–∞–ª–∏ —Ñ–∞–π–ª –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–π, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π')
  process.exit(1)
}

// –°–æ—Ö—Ä–∞–Ω—è–µ–º README
writeFileSync('README.md', readmeTemplate)
console.log('‚úÖ README.md —Å–æ–∑–¥–∞–Ω!')
console.log('\nüìù –¢–µ–ø–µ—Ä—å:')
console.log('   1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –¥–æ–±–∞–≤—å –¥–µ—Ç–∞–ª–∏')
console.log('   2. –î–æ–±–∞–≤—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã/–¥–µ–º–æ')
console.log('   3. npm run _ update-readme ‚Äî –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –≤–µ—Ä—Å–∏–π')
